<div class="container center">

  <app-loading *ngIf="isUserShippingFetching"></app-loading>

  <hr class="my-md-5">
  <div class="row"> Finish your order</div>
  <hr class="my-md-5">

  <mat-horizontal-stepper linear #stepper *ngIf="!isUserShippingFetching">
    <mat-step [stepControl]="firstFormGroup">
      <form [formGroup]="firstFormGroup">
        <ng-template matStepLabel>Check Your Address</ng-template>

        <input hidden="hidden" name="id" [value]="shippingAddress.id"/>
        <div class="form-group">
          <label for="userShippingName">* Name</label>
          <input type="text" class="form-control" id="userShippingName" placeholder="Shipping Name"
                 name="userShippingName" required="required" [value]="shippingAddress.shippingName"/>
        </div>
        <div class="form-group">
          <label for="userShippingHouseNr">* Home Number </label>
          <input type="text" class="form-control" id="userShippingHouseNr" placeholder="House Number"
                 name="userShippingHouseNr" required="required" [value]="shippingAddress.shippingHouseNr"/>
        </div>
        <div class="form-group">
          <label for="userShippingApartmentNr">* Apartment Number</label>
          <input type="text" class="form-control" id="userShippingApartmentNr" placeholder="Apartment Number"
                 name="userShippingApartmentNr" required="required"
                 [value]="shippingAddress.shippingApartmentNr"/>
        </div>
        <div class="form-group">
          <label for="userShippingStreet">* Street</label>
          <input type="text" class="form-control" id="userShippingStreet" placeholder="Street Name"
                 name="userShippingStreet" required="required" [value]="shippingAddress.shippingStreet"/>
        </div>
        <div class="form-group">
          <label for="shippingCity">* City</label>
          <input type="text" class="form-control" id="shippingCity" placeholder="Shipping City"
                 name="userShippingCity" required="required" [value]="shippingAddress.shippingCity"/>
        </div>
        <div class="form-group">
          <label for="userShippingZipcode">* Zipcode</label>
          <input type="text" class="form-control" id="userShippingZipcode" placeholder="Zip Code"
                 name="userShippingZipcode" required="required" [value]="shippingAddress.shippingZipCode"/>
        </div>
      </form>
      <hr>
      <div>
        <button mat-button matStepperNext>Next</button>
      </div>
    </mat-step>
    <mat-step>
      <form>
        <ng-template matStepLabel>Check Your Payment Information</ng-template>

        <div class="row">

          <div class="col-sm col-4">
            <br>
            <input hidden="hidden" name="id" [(ngModel)]="payment.id"/>
            <div class="form-group">
              <h5>* Give a name for your card:</h5>
              <input type="text" class="form-control" id="cardName" placeholder="Card Name" name="cardName"
                     required="required" [(ngModel)]="payment.cardName == undefined ? '' : payment.cardName"/>
            </div>
            <!-- Billing Address -->
            <div class="form-group">
              <label for="billingName">* Name</label>
              <input type="text" class="form-control" id="billingName" placeholder="Receiver name"
                     name="userBillingName" required="required"
                     [(ngModel)]="billingAddress.billingName == undefined ? '' : billingAddress.billingName"/>
            </div>
            <div class="form-group">
              <label for="userBillingStreet">* Street Address</label>
              <input type="text" class="form-control" id="userBillingStreet" placeholder="Street "
                     name="userBillingStreet" required="required"
                     [(ngModel)]="billingAddress.billingStreet == undefined ? '' : billingAddress.billingStreet"/>
            </div>

            <div class="form-group">
              <label for="userBillingCity">* City</label>
              <input type="text" class="form-control" id="userBillingCity" placeholder="Billing City"
                     name="userBillingCity" required="required"
                     [(ngModel)]="billingAddress.billingCity == undefined ? '' : billingAddress.billingCity"/>
            </div>

            <div class="form-group">
              <label for="userBillingZipCode">* Zipcode</label>
              <input type="text" class="form-control" id="userBillingZipCode" placeholder="Zipcode"
                     name="userBillingZipCode" required="required"
                     [(ngModel)]="billingAddress.billingZipCode == undefined ? '' : billingAddress.billingZipCode"/>
            </div>
            <!-- User PaymentOrder -->
          </div>
          <div class="col-sm col-4">
            <br>
            <div class="form-group">
              <h5>* Specify your card</h5>
              <select id="cardType" class="form-control" name="cardType"
                      [(ngModel)]="payment.type == undefined ? '' : payment.type"
                      required="required">
                <option value="" disabled>-- Card Type --</option>
                <option value="visa">Visa</option>
                <option value="mastercard">Mastercard</option>
                <option value="discover">Discover</option>
                <option value="amex">American Express</option>
              </select>
            </div>

            <div class="form-group">
              <label for="cardNumber">* Card Number</label>
              <div class="input-group">
                <input required="required" id="cardNumber" type="tel" class="form-control" name="cardNumber"
                       placeholder="Valid Card Number"
                       [(ngModel)]="payment.cardNumber == undefined ? '' : payment.cardNumber"/>
                <span class="input-group-addon"><i class="fa fa-credit-card"></i></span>
              </div>
            </div>

            <div class="form-group">
              <label for="cardCVC">CV Code</label>
              <input id="cardCVC" type="tel" class="form-control" name="cardCVC" placeholder="CVC"
                     [(ngModel)]="payment.cvc == undefined ? '' : payment.cvc"/>
            </div>
            <br>
            <img class="cardImg"
                 src="https://c7.uihere.com/files/108/642/408/credit-card-logos-sketch-file.png"/>
          </div>

        </div>
      </form>
      <hr>
      <div>
        <button mat-button matStepperNext>Next</button>
      </div>
    </mat-step>
    <mat-step>
      <ng-template matStepLabel>Food Review</ng-template>

      <table mat-table [dataSource]="cartItemList" class="mat-elevation-z8">
        <!-- Item Column -->
        <ng-container matColumnDef="item">
          <th mat-header-cell *matHeaderCellDef> Item</th>
          <td mat-cell *matCellDef="let cartItem"> {{cartItem.food.name}} </td>
          <td mat-footer-cell *matFooterCellDef><strong>Total</strong></td>
        </ng-container>

        <!-- Cost Column -->
        <ng-container matColumnDef="cost">
          <th mat-header-cell *matHeaderCellDef> Cost</th>
          <td mat-cell *matCellDef="let cartItem"> {{cartItem.food.price}} PLN</td>
          <td mat-footer-cell *matFooterCellDef><strong>{{getTotalCost()}} PLN</strong></td>
        </ng-container>

        <!-- Cost Column -->
        <ng-container matColumnDef="quantity">
          <th mat-header-cell *matHeaderCellDef> Quantity</th>
          <td mat-cell *matCellDef="let cartItem"> {{cartItem.qty}}</td>
          <td mat-footer-cell *matFooterCellDef><strong>{{getTotalQty()}}</strong></td>
        </ng-container>


        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        <tr mat-footer-row *matFooterRowDef="displayedColumns"></tr>
      </table>

      <hr>
      <div>
        <button mat-button matStepperPrevious>Back</button>
        <button mat-button (click)="onSubmit()">Confirm Your Order</button>
      </div>
    </mat-step>
  </mat-horizontal-stepper>
</div>
